<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DORMIANS TINDAHAN</title>
    <meta name="description" content="Store Management System" />
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lucide-icons@0.15.10/dist/umd/lucide-icons.min.js">
  </head>
  <body>
    <div id="app">
      <!-- Preview Page -->
      <div id="previewPage" class="page active">
        <div class="container">
          <div class="page-header">
            <h1>Available Items</h1>
            <p></p>
          </div>
          <div class="product-table-card">
            <h2>Top Products</h2>
            <div id="productTableContainer">
              <table id="productTable">
                <thead>
                  <tr>
                    <th>Product</th>
                    <th>Stock</th>
                    <th>Price</th>
                    <th>Total Value</th>
                  </tr>
                </thead>
                <tbody id="productTableBody">
                  <!-- Products will be added here by JavaScript -->
                </tbody>
              </table>
              <div id="noProductsMessage" class="no-data-message">
                No products in inventory yet.
              </div>
            </div>
          </div>
          <div class="login-link">
            <p>Already have an account? <a href="#" id="goToLogin">Sign In</a></p>
          </div>
        </div>
      </div>

      <!-- Login Page -->
      <div id="loginPage" class="page">
        <div class="login-container">
          <div class="login-card">
            <div class="login-header">
              <div class="login-logo">
                <div class="logo-circle">D</div>
              </div>
              <h1>DORMNIANS Tindahan</h1>
              <p>Sign in to access your store dashboard</p>
            </div>
            <form id="loginForm" class="login-form">
              <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" placeholder="Enter your username" required>
                <p class="error-text" id="usernameError"></p>
              </div>
              <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter your password" required>
                <p class="error-text" id="passwordError"></p>
              </div>
              <button type="submit" class="btn btn-primary" id="loginButton">
                Sign In
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-log-in"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
              </button>
            </form>
            <div class="login-footer">
              <p>© <span id="currentYear"></span> DORMIANS Tindahan. All rights reserved.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- App Layout (for Dashboard, Inventory, Manage pages) -->
      <div id="appLayout" class="page">
        <header id="navbar">
          <div class="container">
            <a href="#" class="logo" id="homeLogo">
              <div class="logo-small">D</div>
              <span class="logo-text">DORMIANS Tindahan</span>
            </a>
            
            <nav class="nav-links">
              <a href="#" class="nav-link" data-page="dashboard">Dashboard</a>
              <a href="#" class="nav-link" data-page="inventory">Inventory</a>
              <a href="#" class="nav-link" data-page="manage">Management</a>
              <a href="#" class="nav-link" id="logoutBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-log-out"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
              </a>
            </nav>

            <button class="mobile-menu-btn">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
            </button>
          </div>
        </header>

        <!-- Dashboard Page -->
        <div id="dashboardPage" class="app-page">
          <div class="container">
            <div class="page-header">
              <h1>Store Dashboard</h1>
              <p>Monitor your store's performance and inventory status at a glance</p>
            </div>
            
            <div class="dashboard-cards">
              <div class="dashboard-card">
                <div class="card-header">
                  <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-package-2"><path d="M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z"/><path d="m3 9 2.45-4.9A2 2 0 0 1 7.24 3h9.52a2 2 0 0 1 1.8 1.1L21 9"/><path d="M12 3v6"/></svg>
                  </div>
                  <div class="card-trend positive">+5.2%</div>
                </div>
                <div class="card-body">
                  <h3>Total Products</h3>
                  <p id="totalProducts">0</p>
                </div>
                <div class="card-footer">
                  <div class="card-update">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-activity-square"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M17 12h-2l-2 5-2-10-2 5H7"/></svg>
                    Updated just now
                  </div>
                </div>
              </div>
              
              <div class="dashboard-card">
                <div class="card-header">
                  <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
                  </div>
                  <div class="card-trend negative">-2.3%</div>
                </div>
                <div class="card-body">
                  <h3>Items in Stock</h3>
                  <p id="totalItems">0</p>
                </div>
                <div class="card-footer">
                  <div class="card-update">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-activity-square"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M17 12h-2l-2 5-2-10-2 5H7"/></svg>
                    Updated just now
                  </div>
                </div>
              </div>
              
              <div class="dashboard-card">
                <div class="card-header">
                  <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-dollar-sign"><line x1="12" x1="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                  </div>
                  <div class="card-trend positive">+3.4%</div>
                </div>
                <div class="card-body">
                  <h3>Inventory Value</h3>
                  <p id="totalValue">₱0.00</p>
                </div>
                <div class="card-footer">
                  <div class="card-update">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-activity-square"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M17 12h-2l-2 5-2-10-2 5H7"/></svg>
                    Updated just now
                  </div>
                </div>
              </div>
            </div>
            
            <div class="product-table-card">
              <h2>Top Products</h2>
              <div id="productTableContainer">
                <table id="productTable">
                  <thead>
                    <tr>
                      <th>Product</th>
                      <th>Stock</th>
                      <th>Price</th>
                      <th>Total Value</th>
                    </tr>
                  </thead>
                  <tbody id="productTableBody">
                    <!-- Products will be added here by JavaScript -->
                  </tbody>
                </table>
                <div id="noProductsMessage" class="no-data-message">
                  No products in inventory yet.
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Inventory Page -->
        <div id="inventoryPage" class="app-page">
          <div class="container">
            <div class="page-header">
              <h1>Add to Inventory</h1>
              <p>Add new items or update existing inventory</p>
            </div>
            
            <div class="inventory-form-card">
              <form id="inventoryForm" class="inventory-form">
                <div class="form-group">
                  <label for="itemName">Item Name</label>
                  <input type="text" id="itemName" placeholder="Enter item name" required>
                  <p class="error-text" id="itemNameError"></p>
                </div>
                
                <div class="form-group">
                  <label for="quantity">Quantity</label>
                  <input type="number" id="quantity" placeholder="Enter quantity" min="1" required>
                  <p class="error-text" id="quantityError"></p>
                </div>
                
                <div class="form-group">
                  <label for="price">Price</label>
                  <input type="number" id="price" placeholder="Enter price" min="0.01" step="0.01" required>
                  <p class="error-text" id="priceError"></p>
                </div>
                
                <button type="submit" class="btn btn-primary" id="addInventoryBtn">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                  Add to Inventory
                </button>
              </form>
              
              <div class="inventory-form-footer">
                Items with the same name will have their quantities updated
              </div>
            </div>
          </div>
        </div>

        <!-- Management Page -->
        <div id="managePage" class="app-page">
          <div class="container">
            <div class="page-header">
              <h1>Inventory Management</h1>
              <p>Manage and track your inventory items</p>
            </div>
            
            <div class="search-card">
              <div class="search-input">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                <input type="text" id="searchInput" placeholder="Search items...">
                <button class="btn btn-primary" onclick="exportToExcel()">Export to Excel</button>
              </div>
            </div>
            
            <div id="manageTableContainer" class="manage-table-card">
              <div class="table-responsive">
                <table id="manageTable">
                  <thead>
                    <tr>
                      <th>Item Name</th>
                      <th>Quantity</th>
                      <th>Price (₱)</th>
                      <th>Total Value (₱)</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="manageTableBody">
                    <!-- Items will be added here by JavaScript -->
                  </tbody>
                </table>
              </div>
              
              <div class="table-footer">
                <div id="totalInventoryValue" class="total-value">
                  Total Inventory Value: <span>₱0.00</span>
                </div>
              </div>
            </div>
            
            <div id="noItemsMessage" class="no-data-card">
              <div class="no-data-message">No items in inventory yet</div>
              <button class="btn btn-primary" id="addFirstItemBtn">Add Your First Item</button>
            </div>
          </div>
        </div>

        <!-- 404 Page -->
        <div id="notFoundPage" class="app-page">
          <div class="not-found-container">
            <div class="not-found-content">
              <div class="not-found-code">404</div>
              <h1>Page Not Found</h1>
              <p>The page you are looking for doesn't exist or has been moved.</p>
              <button class="btn btn-light" id="backToHomeBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
                Back to Home
              </button>
            </div>
          </div>
        </div>
        
        <footer>
          <div class="container">
            <p>© <span id="footerYear"></span> JEKZ Store. All rights reserved.</p>
          </div>
        </footer>
      </div>
    </div>

    <!-- Toast notification system -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Logout Options Modal -->
    <div id="logoutModal" class="modal">
      <div class="modal-content">
        <h2>Logged Out</h2>
        <p>What would you like to do next?</p>
        <p>Date: <span id="logoutDate"></span></p>
        <p>Products today: <span id="productsToday"></span></p>
        <button id="viewPreviewBtn" class="btn btn-light">View Preview Page</button>
        <button id="loginAgainBtn" class="btn btn-primary">Log In Again</button>
      </div>
    </div>

    <style>
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.5);
      }
      .modal-content {
        background-color: #fff;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 400px;
        text-align: center;
      }
    </style>

    <script src="script.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        fetch('/inventory')
          .then(response => response.json())
          .then(data => {
            const productTableBody = document.getElementById('productTableBody');
            productTableBody.innerHTML = '';
            if (data.length > 0) {
              data.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                  <td>${item.name}</td>
                  <td>${item.quantity}</td>
                  <td>${item.price}</td>
                  <td>${(item.quantity * item.price).toFixed(2)}</td>
                `;
                productTableBody.appendChild(row);
              });
              document.getElementById('noProductsMessage').style.display = 'none';
            } else {
              document.getElementById('noProductsMessage').style.display = 'block';
            }
          })
          .catch(error => console.error('Error fetching inventory:', error));
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  </body>
</html>